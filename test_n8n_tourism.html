<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æµ‹è¯• n8n æ—…æ¸¸å·¥ä½œæµ</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1000px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        h2 { color: #333; margin-top: 0; }
        button { padding: 10px 20px; background: #52c41a; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #389e0d; }
        pre { background: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto; white-space: pre-wrap; }
        .success { color: green; }
        .error { color: red; }
        input, select { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>ğŸ§ª n8n æ—…æ¸¸å·¥ä½œæµæµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>1. æµ‹è¯•è¯­éŸ³è®²è§£ (AIç”Ÿæˆ)</h2>
        <input type="text" id="spotName" value="è¥¿æŸå¡" placeholder="æ™¯ç‚¹åç§°">
        <button onclick="testAudioGuide()">è·å–è¯­éŸ³è®²è§£</button>
        <pre id="audioResult">ç‚¹å‡»æŒ‰é’®æµ‹è¯•...</pre>
    </div>

    <div class="test-section">
        <h2>2. æµ‹è¯•çƒ­é—¨è·¯çº¿</h2>
        <button onclick="testRoutes()">è·å–çƒ­é—¨è·¯çº¿</button>
        <pre id="routesResult">ç‚¹å‡»æŒ‰é’®æµ‹è¯•...</pre>
    </div>

    <div class="test-section">
        <h2>3. æµ‹è¯•AIè¡Œç¨‹è§„åˆ’</h2>
        <input type="text" id="planSpots" value="è¥¿æŸå¡,ç‹¼ç‰™å±±" placeholder="æ™¯ç‚¹(é€—å·åˆ†éš”)">
        <select id="planDays">
            <option value="1">1å¤©</option>
            <option value="2">2å¤©</option>
            <option value="3">3å¤©</option>
        </select>
        <button onclick="testAIPlan()">AIç”Ÿæˆè¡Œç¨‹</button>
        <pre id="planResult">ç‚¹å‡»æŒ‰é’®æµ‹è¯•...</pre>
    </div>

    <div class="test-section">
        <h2>4. æµ‹è¯•AIèŠå¤©</h2>
        <input type="text" id="chatQuestion" value="è¥¿æŸå¡æœ‰ä»€ä¹ˆå¿…çœ‹æ™¯ç‚¹ï¼Ÿ" placeholder="é—®é¢˜" style="width: 300px;">
        <button onclick="testAIChat()">å‘é€é—®é¢˜</button>
        <pre id="chatResult">ç‚¹å‡»æŒ‰é’®æµ‹è¯•...</pre>
    </div>

    <script>
        const N8N_URL = 'http://localhost:5678';

        async function testAudioGuide() {
            const spotName = document.getElementById('spotName').value;
            const resultEl = document.getElementById('audioResult');
            resultEl.textContent = 'è¯·æ±‚ä¸­...';
            
            try {
                const res = await fetch(`${N8N_URL}/webhook/tourism/audio-guide`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ spotName })
                });
                const data = await res.json();
                resultEl.innerHTML = `<span class="success">âœ… æˆåŠŸ</span>\n${JSON.stringify(data, null, 2)}`;
            } catch (e) {
                resultEl.innerHTML = `<span class="error">âŒ é”™è¯¯: ${e.message}</span>\n\nå¯èƒ½åŸå› :\n1. n8n æœªè¿è¡Œ\n2. å·¥ä½œæµæœªæ¿€æ´»\n3. å‡­è¯æœªé…ç½®`;
            }
        }

        async function testRoutes() {
            const resultEl = document.getElementById('routesResult');
            resultEl.textContent = 'è¯·æ±‚ä¸­...';
            
            try {
                const res = await fetch(`${N8N_URL}/webhook/tourism/routes`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({})
                });
                const data = await res.json();
                resultEl.innerHTML = `<span class="success">âœ… æˆåŠŸ</span>\n${JSON.stringify(data, null, 2)}`;
            } catch (e) {
                resultEl.innerHTML = `<span class="error">âŒ é”™è¯¯: ${e.message}</span>`;
            }
        }

        async function testAIPlan() {
            const spots = document.getElementById('planSpots').value.split(',').map(s => s.trim());
            const duration = parseInt(document.getElementById('planDays').value);
            const resultEl = document.getElementById('planResult');
            resultEl.textContent = 'è¯·æ±‚ä¸­... (AIç”Ÿæˆå¯èƒ½éœ€è¦10-30ç§’)';
            
            try {
                const res = await fetch(`${N8N_URL}/webhook/tourism/ai-plan`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ spots, duration, startDate: new Date().toISOString().split('T')[0] })
                });
                const data = await res.json();
                resultEl.innerHTML = `<span class="success">âœ… æˆåŠŸ</span>\n${JSON.stringify(data, null, 2)}`;
            } catch (e) {
                resultEl.innerHTML = `<span class="error">âŒ é”™è¯¯: ${e.message}</span>`;
            }
        }

        async function testAIChat() {
            const question = document.getElementById('chatQuestion').value;
            const resultEl = document.getElementById('chatResult');
            resultEl.textContent = 'è¯·æ±‚ä¸­...';
            
            try {
                const res = await fetch(`${N8N_URL}/webhook/tourism/ai-chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question, sessionId: 'test-' + Date.now() })
                });
                const data = await res.json();
                resultEl.innerHTML = `<span class="success">âœ… æˆåŠŸ</span>\n${JSON.stringify(data, null, 2)}`;
            } catch (e) {
                resultEl.innerHTML = `<span class="error">âŒ é”™è¯¯: ${e.message}</span>`;
            }
        }
    </script>
</body>
</html>
