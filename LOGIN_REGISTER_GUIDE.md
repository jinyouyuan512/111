# 登录注册功能说明

## 功能概述

已为冀忆红途平台添加完整的用户登录注册功能，包括：

- ✅ 用户注册页面
- ✅ 用户登录页面
- ✅ 导航栏登录状态显示
- ✅ 用户信息下拉菜单
- ✅ 退出登录功能
- ✅ Token自动保存和恢复

## 新增文件

### 前端文件

1. **`frontend/src/views/Login.vue`** - 登录注册页面
   - 包含登录和注册两个标签页
   - 表单验证
   - 美观的渐变背景设计

2. **`frontend/src/api/auth.ts`** - 认证相关API
   - 用户注册接口
   - 用户登录接口
   - 刷新令牌接口
   - 获取当前用户信息接口

### 修改文件

1. **`frontend/src/router/index.ts`** - 添加登录路由
2. **`frontend/src/components/NavBar.vue`** - 更新导航栏
   - 未登录时显示"登录/注册"按钮
   - 登录后显示用户头像和昵称
   - 用户下拉菜单（个人中心、我的订单、购物车、退出登录）
3. **`frontend/src/stores/user.ts`** - 更新用户状态管理
   - 自动从localStorage恢复登录状态

## 使用方法

### 访问登录页面

在浏览器中访问：`http://localhost:5173/login`

或点击导航栏右上角的"登录/注册"按钮

### 注册新用户

1. 在登录页面切换到"注册"标签
2. 填写以下信息：
   - **用户名**（必填）：3-20个字符，只能包含字母、数字和下划线
   - **邮箱**（必填）：有效的邮箱地址
   - **密码**（必填）：至少6个字符
   - **确认密码**（必填）：需与密码一致
   - **昵称**（可选）：显示名称
   - **手机号**（可选）：11位手机号
3. 点击"注册"按钮
4. 注册成功后会自动切换到登录标签

### 登录

1. 在登录页面的"登录"标签
2. 输入用户名和密码
3. 点击"登录"按钮
4. 登录成功后会跳转到首页，导航栏显示用户信息

### 退出登录

1. 点击导航栏右上角的用户头像/昵称
2. 在下拉菜单中选择"退出登录"

## 后端API对接

登录注册功能已对接以下后端API：

- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/refresh` - 刷新令牌
- `GET /api/users/me` - 获取当前用户信息

## 测试账号

可以使用以下测试账号登录（需要先在后端数据库中创建）：

```
用户名: testuser
密码: password123
```

或者直接注册新账号进行测试。

## 功能特性

### 表单验证

- ✅ 用户名格式验证（3-20字符，字母数字下划线）
- ✅ 邮箱格式验证
- ✅ 密码长度验证（至少6位）
- ✅ 确认密码一致性验证
- ✅ 手机号格式验证（可选）

### 安全特性

- ✅ 密码输入框支持显示/隐藏
- ✅ JWT Token自动保存到localStorage
- ✅ 请求自动携带Authorization头
- ✅ 刷新令牌机制

### 用户体验

- ✅ 响应式设计，支持移动端
- ✅ 美观的渐变背景
- ✅ 加载状态提示
- ✅ 错误信息提示
- ✅ 成功提示
- ✅ 自动跳转

## 后续优化建议

1. **添加忘记密码功能**
   - 邮箱验证码重置密码
   - 手机验证码重置密码

2. **第三方登录**
   - 微信登录
   - QQ登录
   - 支付宝登录

3. **个人中心页面**
   - 查看和编辑个人信息
   - 修改密码
   - 上传头像
   - 查看学习进度
   - 查看收藏和足迹

4. **Token刷新机制**
   - 自动刷新即将过期的token
   - 无感知续期

5. **记住我功能**
   - 保存登录状态更长时间

6. **登录安全**
   - 图形验证码
   - 短信验证码
   - 登录日志
   - 异常登录提醒

## 注意事项

1. 确保后端服务已启动并运行在正确的端口
2. 确保数据库已正确初始化
3. 前端代理配置需要正确指向后端API
4. Token过期时间为2小时，刷新令牌有效期为7天

## 启动项目

### 启动后端

```bash
cd backend
mvn spring-boot:run -pl user-service
```

### 启动前端

```bash
cd frontend
npm run dev
```

然后访问 `http://localhost:5173/login` 即可看到登录注册页面。
