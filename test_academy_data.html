<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ä¼ æ‰¿å­¦é™¢æ•°æ®æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background: #e8f5e9; border-color: #4caf50; }
        .error { background: #ffebee; border-color: #f44336; }
        .info { background: #e3f2fd; border-color: #2196f3; }
        h2 { margin-top: 0; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; max-height: 300px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        .btn-primary { background: #c41e3a; color: white; border: none; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>ğŸ“ ä¼ æ‰¿å­¦é™¢æ•°æ®æµ‹è¯•</h1>
    
    <div class="section info">
        <h2>ğŸ“‹ æµ‹è¯•è¯´æ˜</h2>
        <p>æ•°æ®è·å–ä¼˜å…ˆçº§ï¼š<strong>n8nå·¥ä½œæµ</strong> â†’ <strong>åç«¯API</strong> â†’ <strong>æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®</strong></p>
        <p>å½“å‰çŠ¶æ€ï¼š</p>
        <ul>
            <li>n8n æœåŠ¡ï¼š<span id="n8n-status">æ£€æµ‹ä¸­...</span></li>
            <li>åç«¯ Academy APIï¼š<span id="backend-status">æ£€æµ‹ä¸­...</span></li>
            <li>å‰ç«¯æœåŠ¡ï¼š<a href="http://localhost:3001/academy" target="_blank">http://localhost:3001/academy</a></li>
        </ul>
    </div>

    <div class="section">
        <h2>ğŸ”§ æµ‹è¯•æ“ä½œ</h2>
        <button class="btn-primary" onclick="testN8nNews()">æµ‹è¯• n8n æ–°é—»æ¥å£</button>
        <button class="btn-primary" onclick="testN8nBooks()">æµ‹è¯• n8n ä¹¦ç±æ¥å£</button>
        <button class="btn-primary" onclick="testBackendNews()">æµ‹è¯•åç«¯æ–°é—»API</button>
        <button class="btn-primary" onclick="testBackendBooks()">æµ‹è¯•åç«¯ä¹¦ç±API</button>
        <button onclick="openAcademyPage()">æ‰“å¼€ä¼ æ‰¿å­¦é™¢é¡µé¢</button>
    </div>

    <div id="n8n-news-result" class="section" style="display:none;">
        <h2>ğŸ“° n8n æ–°é—»æ•°æ®</h2>
        <pre id="n8n-news-data"></pre>
    </div>

    <div id="n8n-books-result" class="section" style="display:none;">
        <h2>ğŸ“– n8n ä¹¦ç±æ•°æ®</h2>
        <pre id="n8n-books-data"></pre>
    </div>

    <div id="backend-news-result" class="section" style="display:none;">
        <h2>ğŸ“° åç«¯æ–°é—»æ•°æ®</h2>
        <pre id="backend-news-data"></pre>
    </div>

    <div id="backend-books-result" class="section" style="display:none;">
        <h2>ğŸ“– åç«¯ä¹¦ç±æ•°æ®</h2>
        <pre id="backend-books-data"></pre>
    </div>

    <script>
        const N8N_BASE = 'http://localhost:5678';
        const BACKEND_BASE = 'http://localhost:8086';

        // æ£€æµ‹æœåŠ¡çŠ¶æ€
        async function checkServices() {
            // æ£€æµ‹ n8n
            try {
                const res = await fetch(`${N8N_BASE}/webhook/academy/news`, { method: 'GET' });
                document.getElementById('n8n-status').innerHTML = res.ok ? 
                    '<span style="color:green">âœ… è¿è¡Œä¸­</span>' : 
                    '<span style="color:orange">âš ï¸ å“åº”å¼‚å¸¸</span>';
            } catch (e) {
                document.getElementById('n8n-status').innerHTML = '<span style="color:red">âŒ æœªå¯åŠ¨</span>';
            }

            // æ£€æµ‹åç«¯
            try {
                const res = await fetch(`${BACKEND_BASE}/academy/news`, { method: 'GET' });
                document.getElementById('backend-status').innerHTML = res.ok ? 
                    '<span style="color:green">âœ… è¿è¡Œä¸­</span>' : 
                    '<span style="color:orange">âš ï¸ å“åº”å¼‚å¸¸</span>';
            } catch (e) {
                document.getElementById('backend-status').innerHTML = '<span style="color:red">âŒ æœªå¯åŠ¨</span>';
            }
        }

        async function testN8nNews() {
            const resultDiv = document.getElementById('n8n-news-result');
            const dataDiv = document.getElementById('n8n-news-data');
            resultDiv.style.display = 'block';
            resultDiv.className = 'section';
            
            try {
                const res = await fetch(`${N8N_BASE}/webhook/academy/news`);
                const data = await res.json();
                dataDiv.textContent = JSON.stringify(data, null, 2);
                resultDiv.classList.add('success');
            } catch (e) {
                dataDiv.textContent = 'é”™è¯¯: ' + e.message + '\n\nn8n æœåŠ¡æœªå¯åŠ¨ï¼Œè¯·è¿è¡Œ: npx n8n start';
                resultDiv.classList.add('error');
            }
        }

        async function testN8nBooks() {
            const resultDiv = document.getElementById('n8n-books-result');
            const dataDiv = document.getElementById('n8n-books-data');
            resultDiv.style.display = 'block';
            resultDiv.className = 'section';
            
            try {
                const res = await fetch(`${N8N_BASE}/webhook/academy/books`);
                const data = await res.json();
                dataDiv.textContent = JSON.stringify(data, null, 2);
                resultDiv.classList.add('success');
            } catch (e) {
                dataDiv.textContent = 'é”™è¯¯: ' + e.message + '\n\nn8n æœåŠ¡æœªå¯åŠ¨ï¼Œè¯·è¿è¡Œ: npx n8n start';
                resultDiv.classList.add('error');
            }
        }

        async function testBackendNews() {
            const resultDiv = document.getElementById('backend-news-result');
            const dataDiv = document.getElementById('backend-news-data');
            resultDiv.style.display = 'block';
            resultDiv.className = 'section';
            
            try {
                const res = await fetch(`${BACKEND_BASE}/academy/news`);
                const data = await res.json();
                dataDiv.textContent = JSON.stringify(data, null, 2);
                resultDiv.classList.add('success');
            } catch (e) {
                dataDiv.textContent = 'é”™è¯¯: ' + e.message + '\n\nacademy-service æœªå¯åŠ¨';
                resultDiv.classList.add('error');
            }
        }

        async function testBackendBooks() {
            const resultDiv = document.getElementById('backend-books-result');
            const dataDiv = document.getElementById('backend-books-data');
            resultDiv.style.display = 'block';
            resultDiv.className = 'section';
            
            try {
                const res = await fetch(`${BACKEND_BASE}/academy/books`);
                const data = await res.json();
                dataDiv.textContent = JSON.stringify(data, null, 2);
                resultDiv.classList.add('success');
            } catch (e) {
                dataDiv.textContent = 'é”™è¯¯: ' + e.message + '\n\nacademy-service æœªå¯åŠ¨';
                resultDiv.classList.add('error');
            }
        }

        function openAcademyPage() {
            window.open('http://localhost:3001/academy', '_blank');
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æµ‹æœåŠ¡
        checkServices();
    </script>
</body>
</html>
