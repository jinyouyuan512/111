# 订单页面快速测试指南

## 测试准备

### 1. 启动服务

**后端服务**
```bash
cd backend/mall-service
mvn spring-boot:run
```
服务地址: http://localhost:8086

**前端服务**
```bash
cd frontend
npm run dev
```
前端地址: http://localhost:5173

### 2. 确保数据库已初始化
```bash
mysql -u root -p < backend/mall-service/src/main/resources/db/migration/V1__init_mall.sql
```

## 功能测试

### 测试1: 订单列表加载

**步骤**:
1. 访问 http://localhost:5173/orders
2. 观察页面加载

**预期结果**:
- ✅ 显示加载骨架屏
- ✅ 加载完成后显示订单列表
- ✅ 如果没有订单，显示空状态

**测试API**:
```bash
curl http://localhost:8086/api/mall/orders?page=1&size=10
```

### 测试2: 空状态显示

**步骤**:
1. 确保用户没有订单
2. 访问订单页面

**预期结果**:
- ✅ 显示精美的空状态图标
- ✅ 显示"您还没有订单"提示
- ✅ 显示"去商城逛逛"按钮
- ✅ 点击按钮跳转到商城页面

### 测试3: 订单状态显示

**步骤**:
1. 创建不同状态的测试订单
2. 刷新订单页面

**预期结果**:
- ✅ 待支付订单显示红色徽章
- ✅ 已支付订单显示深红色徽章
- ✅ 已发货订单显示紫红色徽章
- ✅ 已完成订单显示绿色徽章
- ✅ 已取消订单显示灰色徽章

### 测试4: 订单支付

**步骤**:
1. 找到一个待支付订单
2. 点击"立即支付"按钮
3. 等待2秒

**预期结果**:
- ✅ 显示"支付成功"提示
- ✅ 订单状态变为"已支付"
- ✅ 2秒后显示"订单已发货"提示
- ✅ 订单状态变为"已发货"
- ✅ 按钮变为"确认收货"

**测试API**:
```bash
curl -X POST http://localhost:8086/api/mall/orders/1/pay?paymentMethod=alipay
```

### 测试5: 确认收货

**步骤**:
1. 找到一个已发货订单
2. 点击"确认收货"按钮

**预期结果**:
- ✅ 显示"确认收货成功"提示
- ✅ 订单状态变为"已完成"
- ✅ 按钮变为"删除订单"

**测试API**:
```bash
curl -X POST http://localhost:8086/api/mall/orders/1/confirm
```

### 测试6: 取消订单

**步骤**:
1. 找到一个待支付订单
2. 点击"取消订单"按钮
3. 在确认对话框中点击"确定"

**预期结果**:
- ✅ 显示确认对话框
- ✅ 点击确定后显示"订单已取消"提示
- ✅ 订单状态变为"已取消"
- ✅ 按钮变为"删除订单"

**测试API**:
```bash
curl -X DELETE http://localhost:8086/api/mall/orders/1
```

### 测试7: 删除订单

**步骤**:
1. 找到一个已完成或已取消的订单
2. 点击"删除订单"按钮
3. 在确认对话框中点击"删除"

**预期结果**:
- ✅ 显示确认对话框
- ✅ 点击删除后显示"订单已删除"提示
- ✅ 订单从列表中移除

### 测试8: 订单详情

**步骤**:
1. 查看订单卡片信息

**预期结果**:
- ✅ 显示订单号
- ✅ 显示创建时间
- ✅ 显示订单状态
- ✅ 显示商品列表
- ✅ 显示商品图标和颜色
- ✅ 显示商品名称和描述
- ✅ 显示商品价格和数量
- ✅ 显示订单总金额

### 测试9: 响应式布局

**步骤**:
1. 按F12打开开发者工具
2. 切换到移动设备视图
3. 测试不同屏幕尺寸

**预期结果**:
- ✅ 桌面端：多列布局
- ✅ 平板端：适配调整
- ✅ 移动端：单列布局
- ✅ 按钮在移动端全宽显示
- ✅ 订单信息垂直排列

### 测试10: 加载状态

**步骤**:
1. 打开网络限速（开发者工具 → Network → Slow 3G）
2. 刷新订单页面

**预期结果**:
- ✅ 显示加载骨架屏
- ✅ 骨架屏有动画效果
- ✅ 加载完成后平滑过渡到内容

### 测试11: 错误处理

**步骤**:
1. 停止后端服务
2. 刷新订单页面

**预期结果**:
- ✅ 控制台显示错误信息
- ✅ 尝试从localStorage加载数据
- ✅ 如果localStorage有数据，显示本地数据
- ✅ 如果没有数据，显示空状态

### 测试12: 继续购物

**步骤**:
1. 点击页面顶部的"继续购物"按钮
2. 或在空状态点击"去商城逛逛"按钮

**预期结果**:
- ✅ 跳转到商城页面 (/mall)

## API测试

### 获取订单列表
```bash
curl http://localhost:8086/api/mall/orders?page=1&size=10
```

### 获取订单详情
```bash
curl http://localhost:8086/api/mall/orders/1
```

### 创建订单
```bash
curl -X POST http://localhost:8086/api/mall/orders \
  -H "Content-Type: application/json" \
  -d '{
    "userId": 1,
    "items": [
      {
        "productId": 1,
        "quantity": 2
      }
    ],
    "shippingAddress": "河北省石家庄市西柏坡",
    "paymentMethod": "alipay"
  }'
```

### 支付订单
```bash
curl -X POST http://localhost:8086/api/mall/orders/1/pay?paymentMethod=alipay
```

### 更新订单状态
```bash
curl -X PUT "http://localhost:8086/api/mall/orders/1/status?status=SHIPPED"
```

### 取消订单
```bash
curl -X DELETE http://localhost:8086/api/mall/orders/1
```

### 确认收货
```bash
curl -X POST http://localhost:8086/api/mall/orders/1/confirm
```

## 性能测试

### 加载时间
- 首次加载: < 2秒
- API响应: < 500ms
- 页面渲染: < 300ms

### 内存占用
- 初始加载: < 50MB
- 运行时: < 100MB

## 浏览器兼容性

### Chrome
- [ ] 页面正常显示
- [ ] 功能正常工作
- [ ] 动画流畅

### Firefox
- [ ] 页面正常显示
- [ ] 功能正常工作
- [ ] 动画流畅

### Safari
- [ ] 页面正常显示
- [ ] 功能正常工作
- [ ] 动画流畅

### Edge
- [ ] 页面正常显示
- [ ] 功能正常工作
- [ ] 动画流畅

## 常见问题

### Q1: 订单列表为空？
**A**: 
1. 检查后端服务是否启动
2. 检查数据库是否有订单数据
3. 检查用户是否登录
4. 查看浏览器控制台错误信息

### Q2: 支付失败？
**A**:
1. 检查订单状态是否为待支付
2. 检查后端API是否正常
3. 查看网络请求是否成功
4. 检查错误提示信息

### Q3: 订单状态不更新？
**A**:
1. 刷新页面
2. 检查localStorage数据
3. 清除浏览器缓存
4. 检查API返回数据

### Q4: 页面显示异常？
**A**:
1. 清除浏览器缓存
2. 检查CSS是否加载
3. 查看控制台错误
4. 尝试其他浏览器

## 测试数据

### 创建测试订单
```sql
-- 插入测试订单
INSERT INTO `order` (order_number, user_id, status, total_amount, payment_method, shipping_address, created_at)
VALUES 
('ORD20260104001', 1, 'PENDING', 299.00, 'alipay', '河北省石家庄市西柏坡', NOW()),
('ORD20260104002', 1, 'PAID', 199.00, 'wechat', '河北省保定市狼牙山', NOW()),
('ORD20260104003', 1, 'SHIPPED', 399.00, 'alipay', '河北省承德市塞罕坝', NOW());

-- 插入订单项
INSERT INTO order_item (order_id, product_id, product_name, price, quantity, subtotal)
VALUES 
(1, 1, '西柏坡精神书签', 29.90, 10, 299.00),
(2, 2, '红色记忆笔记本', 99.50, 2, 199.00),
(3, 3, '革命徽章套装', 199.50, 2, 399.00);
```

## 测试报告模板

### 测试信息
- 测试日期: ___________
- 测试人员: ___________
- 测试环境: ___________
- 浏览器版本: ___________

### 测试结果
| 测试项 | 状态 | 备注 |
|--------|------|------|
| 订单列表加载 | ☐ 通过 ☐ 失败 | |
| 空状态显示 | ☐ 通过 ☐ 失败 | |
| 订单支付 | ☐ 通过 ☐ 失败 | |
| 确认收货 | ☐ 通过 ☐ 失败 | |
| 取消订单 | ☐ 通过 ☐ 失败 | |
| 删除订单 | ☐ 通过 ☐ 失败 | |
| 响应式布局 | ☐ 通过 ☐ 失败 | |
| 加载状态 | ☐ 通过 ☐ 失败 | |
| 错误处理 | ☐ 通过 ☐ 失败 | |

### 问题记录
1. 
2. 
3. 

### 总体评价
☐ 优秀  ☐ 良好  ☐ 一般  ☐ 需改进

---

测试完成后，请将结果反馈给开发团队！
